function[reg1,reg2,SBTn]=getSBTn(Fr,Qt)

%% defines reg1
reg1=cell(9,1);
reg1{1}=[0.1	1
    0.1	10
    0.112843912	9.879542688
    0.168812751	9.526807029
    0.232995181	9.021176043
    0.313059453	8.088998164
    0.468332111	6.503660984
    0.620873202	5.32495313
    0.729413439	4.521298265
    0.880250771	3.701869056
    1.048113134	2.922735225
    1.264855217	2.107095456
    1.42731211	1.604217161
    1.654469983	1.095150193
    1.676832937	1];
reg1{2}=[1.676832937	1
    1.654469983	1.095150193
    2.345645572	1.313472706
    3.752701522	1.855329511
    5.465241147	2.767612371
    7.053367323	3.909356383
    8.62700517	5.522112666
    10	7.521696219
    10	1
    ];
reg1{3}=[1.654469983	1.095150193
    1.42731211	1.604217161
    1.264855217	2.107095456
    1.048113134	2.922735225
    0.880250771	3.701869056
    0.729413439	4.521298265
    0.993309406	5.522112666
    1.567961075	7.800191466
    2.345645572	11.63561851
    3.325568434	18.32980711
    4.589946042	32.20288172
    5.539113105	50.72980091
    6.003792251	64.25319632
    7.442521821	59.7469568
    10	57.61377282
    10	7.521696219
    8.62700517	5.522112666
    7.053367323	3.909356383
    5.465241147	2.767612371
    3.752701522	1.855329511
    2.345645572	1.313472706
    ];
reg1{4}=[0.313059453	8.088998164
    0.468332111	6.503660984
    0.620873202	5.32495313
    0.729413439	4.521298265
    0.993309406	5.522112666
    1.567961075	7.800191466
    2.345645572	11.63561851
    3.325568434	18.32980711
    4.589946042	32.20288172
    5.539113105	50.72980091
    6.003792251	64.25319632
    4.714866363	75.6741181
    3.854835332	97.60536373
    3.416077358	71.65774841
    2.755708248	48.0373396
    1.943702251	29.944412
    1.370964594	20.81713951
    0.868511374	14.47192542
    0.535627633	10.62467831
    ];
reg1{5}=[0.1	26.3
    0.1	10
    0.112843912	9.879542688
    0.168812751	9.526807029
    0.232995181	9.021176043
    0.313059453	8.088998164
    0.535627633	10.62467831
    0.868511374	14.47192542
    1.370964594	20.81713951
    1.943702251	29.944412
    2.755708248	48.0373396
    3.416077358	71.65774841
    3.854835332	97.60536373
    3.068177399	148.269776
    2.475061563	233.5721469
    2.19334966	181.0901118
    1.676832937	114.9545897
    1.020343391	66.63220888
    0.58056172	43.86370006
    0.358043555	34.63168991
    0.209266499	29.40499112
    0.120679264	26.36650899
    ];
reg1{6}=[0.1	154
    0.1	26.3
    0.120679264	26.36650899
    0.209266499	29.40499112
    0.358043555	34.63168991
    0.58056172	43.86370006
    1.020343391	66.63220888
    1.676832937	114.9545897
    2.19334966	181.0901118
    2.475061563	233.5721469
    2.023589648	374.7004464
    1.610634823	670.3718812
    1.389495494	1000
    1.034135054	1000
    0.92881673	747.6256802
    0.739272693	501.1872336
    0.528484276	342.1452589
    0.372759372	251.1886432
    0.262920877	201.958975
    0.17109454	171.4788358
    0.12396368	156.5801995
    ];
reg1{7}=[0.1	1000
    0.1	154
    0.12396368	156.5801995
    0.17109454	171.4788358
    0.262920877	201.958975
    0.372759372	251.1886432
    0.528484276	342.1452589
    0.739272693	501.1872336
    0.92881673	747.6256802
    1.034135054	1000
    ];
reg1{8}=[1.389495494	1000
    1.610634823	670.3718812
    2.023589648	374.7004464
    2.475061563	233.5721469
    3.068177399	148.269776
    3.854835332	97.60536373
    4.067517649	119.2108513
    4.29193426	159.4525904
    4.651986909	354.8133892
    4.778595739	670.3718812
    4.843186525	1000
    ];
reg1{9}=[4.843186525	1000
    4.778595739	670.3718812
    4.651986909	354.8133892
    4.29193426	159.4525904
    4.067517649	119.2108513
    3.854835332	97.60536373
    4.714866363	75.6741181
    6.003792251	64.25319632
    7.442521821	59.7469568
    10	57.61377282
    10	1000
    ];

%% defines reg2
reg2=cell(7,1);
reg2{1}=[0.817356471	1
1.405602199	1
1.4	10.8875873];
reg2{2}=[0.150709513	1
0.817356471	1
0.543632117	2.600152483];
reg2{3}=[-0.552773015	19.50071579
0.150709513	1
0.543632117	2.600152483
0.817356471	1
1.4	10.8875873
0.602019157	48.00190791
0	5.128889646
-0.400567611	62.52367009];
reg2{4}=[-0.400567611	62.52367009
0	5.128889646
0.602019157	48.00190791
0.417412641	66.75277784
0	11.86142204
-0.316017265	118.2373495];
reg2{5}=[-0.316017265	118.2373495
0	11.86142204
0.417412641	66.75277784
0.22163129	96.28431588
0	31.16439671
-0.248362207	200.4649144];
reg2{6}=[-0.248362207	200.4649144
0	31.16439671
0.22163129	96.28431588
0.176902383	107.4548395
0.132897771	292.9249344
0	176.0483902
-0.158180098	393.1492405];
reg2{7}=[-0.158180098	393.1492405
0	176.0483902
0.132897771	292.9249344
0.083483119	1000
-0.039780051	1000];

%%
if nargin==0
    SBTn=[];
    return
end

%% computes SBT
Np  = length(Qt);
SBTn = nan(Np,9);
for i=1:9
    SBTn(:,i) = i*inpolygon(Fr,Qt,reg1{i}(:,1),reg1{i}(:,2));
end
SBTn=sum(SBTn,2);
SBTn(SBTn==0)=NaN;
